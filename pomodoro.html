<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Focus Timer – Pomodoro</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=DM+Mono:wght@300;400;500&family=Syne:wght@700;800&display=swap" rel="stylesheet">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.23.2/babel.min.js"></script>

  <style>
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
    body {
      min-height: 100vh;
      background: #0C0C0F;
      display: flex;
      align-items: center;
      justify-content: center;
      font-family: 'DM Mono', 'Courier New', monospace;
      padding: 24px;
    }

    .pomo-btn {
      background: none;
      border: 1px solid rgba(255,255,255,0.09);
      color: #888;
      font-family: 'DM Mono', monospace;
      font-size: 11px;
      letter-spacing: 0.12em;
      cursor: pointer;
      padding: 8px 4px;
      border-radius: 3px;
      transition: all 0.2s;
      text-transform: uppercase;
      flex: 1;
    }
    .pomo-btn:hover { border-color: rgba(255,255,255,0.2); color: #ccc; }
    .pomo-btn.active-focus  { border-color: #F97316; color: #F97316; background: rgba(249,115,22,0.08); }
    .pomo-btn.active-short  { border-color: #38BDF8; color: #38BDF8; background: rgba(56,189,248,0.08); }
    .pomo-btn.active-long   { border-color: #A78BFA; color: #A78BFA; background: rgba(167,139,250,0.08); }

    .ctrl-main {
      flex: 1;
      padding: 16px;
      border: none;
      border-radius: 4px;
      color: #fff;
      font-family: 'DM Mono', monospace;
      font-size: 13px;
      letter-spacing: 0.1em;
      text-transform: uppercase;
      cursor: pointer;
      transition: filter 0.18s, transform 0.18s;
    }
    .ctrl-main:hover { filter: brightness(1.15); transform: translateY(-1px); }
    .ctrl-main:active { transform: scale(0.97); }

    .ctrl-reset {
      padding: 16px 20px;
      background: rgba(255,255,255,0.04);
      color: #666;
      border: 1px solid rgba(255,255,255,0.07);
      border-radius: 4px;
      font-size: 18px;
      cursor: pointer;
      transition: filter 0.18s, transform 0.18s;
    }
    .ctrl-reset:hover { color: #aaa; border-color: rgba(255,255,255,0.15); transform: translateY(-1px); }
    .ctrl-reset:active { transform: scale(0.97); }

    .stat-card {
      background: rgba(255,255,255,0.02);
      border: 1px solid rgba(255,255,255,0.05);
      border-radius: 8px;
      padding: 16px;
      flex: 1;
    }

    .log-box {
      background: rgba(255,255,255,0.02);
      border: 1px solid rgba(255,255,255,0.05);
      border-radius: 8px;
      padding: 16px;
      margin-top: 0;
    }

    .log-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 8px 0;
      border-bottom: 1px solid rgba(255,255,255,0.03);
      font-size: 12px;
      animation: fadeIn 0.4s ease;
    }
    .log-item:last-child { border-bottom: none; }
    @keyframes fadeIn { from { opacity: 0; transform: translateY(-8px); } to { opacity: 1; transform: none; } }

    @keyframes pulse {
      0%, 100% { opacity: 0.2; transform: scale(0.8); }
      50% { opacity: 1; transform: scale(1.2); }
    }
    @keyframes ringPulse {
      0%, 100% { filter: drop-shadow(0 0 6px currentColor); }
      50% { filter: drop-shadow(0 0 14px currentColor); }
    }
    .ring-pulse { animation: ringPulse 2s ease-in-out infinite; }
  </style>
</head>
<body>

<div id="root"></div>

<script type="text/babel">
  const { useState, useEffect, useRef, useCallback } = React;

  const MODES = {
    focus: { label: "FOCUS",       duration: 25 * 60, color: "#F97316" },
    short: { label: "SHORT BREAK", duration:  5 * 60, color: "#38BDF8" },
    long:  { label: "LONG BREAK",  duration: 15 * 60, color: "#A78BFA" },
  };

  const SIZE = 280, STROKE = 10;
  const R    = (SIZE - STROKE) / 2;
  const CIRC = 2 * Math.PI * R;

  const pad = n => String(n).padStart(2, "0");
  const fmt = s => `${pad(Math.floor(s / 60))}:${pad(s % 60)}`;

  function App() {
    const [mode,       setMode]       = useState("focus");
    const [timeLeft,   setTimeLeft]   = useState(MODES.focus.duration);
    const [running,    setRunning]    = useState(false);
    const [sessions,   setSessions]   = useState(0);
    const [totalFocus, setTotalFocus] = useState(0);
    const [log,        setLog]        = useState([]);
    const intervalRef = useRef(null);
    const sessRef     = useRef(0); // mirror of sessions for use inside interval

    const cfg      = MODES[mode];
    const total    = cfg.duration;
    const progress = timeLeft / total;
    const dash     = CIRC * progress;

    const resetTimer = useCallback((m) => {
      clearInterval(intervalRef.current);
      setRunning(false);
      setTimeLeft(MODES[m].duration);
    }, []);

    const switchMode = m => { resetTimer(m); setMode(m); };

    useEffect(() => {
      if (!running) { clearInterval(intervalRef.current); return; }
      intervalRef.current = setInterval(() => {
        setTimeLeft(prev => {
          if (prev <= 1) {
            clearInterval(intervalRef.current);
            setRunning(false);
            if (mode === "focus") {
              const next = sessRef.current + 1;
              sessRef.current = next;
              setSessions(next);
              setTotalFocus(t => t + MODES.focus.duration);
              setLog(l => [
                { label: `Session ${next}`, mins: 25,
                  time: new Date().toLocaleTimeString([], { hour: "2-digit", minute: "2-digit" }) },
                ...l.slice(0, 4)
              ]);
            }
            return 0;
          }
          return prev - 1;
        });
      }, 1000);
      return () => clearInterval(intervalRef.current);
    }, [running, mode]);

    const toggle = () => setRunning(r => !r);
    const reset  = () => resetTimer(mode);
    const totalMins = Math.floor(totalFocus / 60);

    return (
      <div style={{ width: "100%", maxWidth: 420 }}>

        {/* Header */}
        <div style={{ marginBottom: 32 }}>
          <div style={{ color: "rgba(255,255,255,0.08)", fontSize: 10, letterSpacing: "0.3em", textTransform: "uppercase", marginBottom: 4 }}>
            Study · Focus · Flow
          </div>
          <h1 style={{ fontFamily: "'Syne', sans-serif", fontWeight: 800, fontSize: 28, color: "#fff", letterSpacing: -0.5 }}>
            Focus Timer
          </h1>
        </div>

        {/* Mode tabs */}
        <div style={{ display: "flex", gap: 8, marginBottom: 36 }}>
          {Object.entries(MODES).map(([key]) => (
            <button key={key}
              className={`pomo-btn ${mode === key ? `active-${key}` : ""}`}
              onClick={() => switchMode(key)}>
              {key === "focus" ? "Focus" : key === "short" ? "Short" : "Long"}
            </button>
          ))}
        </div>

        {/* Timer ring */}
        <div style={{ display: "flex", flexDirection: "column", alignItems: "center", marginBottom: 32 }}>
          <div style={{ position: "relative", width: SIZE, height: SIZE }}>

            {/* Track */}
            <svg width={SIZE} height={SIZE} style={{ position: "absolute", top: 0, left: 0, transform: "rotate(-90deg)" }}>
              <circle cx={SIZE/2} cy={SIZE/2} r={R} fill="none" stroke="rgba(255,255,255,0.04)" strokeWidth={STROKE} />
            </svg>

            {/* Progress */}
            <svg width={SIZE} height={SIZE}
              className={running ? "ring-pulse" : ""}
              style={{ position: "absolute", top: 0, left: 0, transform: "rotate(-90deg)", color: cfg.color }}>
              <circle cx={SIZE/2} cy={SIZE/2} r={R}
                fill="none"
                stroke={cfg.color}
                strokeWidth={STROKE}
                strokeLinecap="round"
                strokeDasharray={CIRC}
                strokeDashoffset={dash}
                style={{ transition: "stroke-dashoffset 0.8s ease, stroke 0.4s" }}
              />
            </svg>

            {/* Center */}
            <div style={{
              position: "absolute", inset: 0,
              display: "flex", flexDirection: "column", alignItems: "center", justifyContent: "center", gap: 6
            }}>
              <div style={{
                fontFamily: "'Syne', sans-serif", fontWeight: 800, fontSize: 72,
                letterSpacing: -2, lineHeight: 1,
                color: timeLeft === 0 ? cfg.color : "#fff",
                transition: "color 0.4s"
              }}>
                {fmt(timeLeft)}
              </div>
              <div style={{ color: cfg.color, fontSize: 10, letterSpacing: "0.25em", fontWeight: 500 }}>
                {cfg.label}
              </div>
              {running && (
                <div style={{ display: "flex", gap: 3, marginTop: 4 }}>
                  {[0,1,2].map(i => (
                    <div key={i} style={{
                      width: 4, height: 4, borderRadius: "50%", background: cfg.color,
                      animation: `pulse 1.2s ease-in-out ${i * 0.2}s infinite`
                    }} />
                  ))}
                </div>
              )}
            </div>
          </div>
        </div>

        {/* Controls */}
        <div style={{ display: "flex", gap: 12, marginBottom: 36 }}>
          <button className="ctrl-main" onClick={toggle} style={{ background: cfg.color }}>
            {running ? "⏸  Pause" : timeLeft < total ? "▶  Resume" : "▶  Start"}
          </button>
          <button className="ctrl-reset" onClick={reset} title="Reset">↺</button>
        </div>

        {/* Stats */}
        <div style={{ display: "flex", gap: 12, marginBottom: 12 }}>
          {[
            { label: "Sessions Today", value: sessions },
            { label: "Focus Time",     value: `${totalMins}m` },
          ].map(({ label, value }) => (
            <div key={label} className="stat-card">
              <div style={{ color: "#444", fontSize: 10, letterSpacing: "0.2em", textTransform: "uppercase", marginBottom: 6 }}>
                {label}
              </div>
              <div style={{ fontFamily: "'Syne', sans-serif", fontWeight: 800, fontSize: 28, color: cfg.color }}>
                {value}
              </div>
            </div>
          ))}
        </div>

        {/* Session Log */}
        <div className="log-box">
          <div style={{ color: "#333", fontSize: 10, letterSpacing: "0.25em", textTransform: "uppercase", marginBottom: 12 }}>
            Session Log
          </div>
          {log.length === 0 ? (
            <div style={{ color: "#2a2a2a", fontSize: 12, textAlign: "center", padding: "16px 0" }}>
              Complete a focus session to begin
            </div>
          ) : log.map((entry, i) => (
            <div key={i} className="log-item">
              <span style={{ color: "#4a4a4a" }}>{entry.label}</span>
              <span style={{ color: cfg.color, fontWeight: 500 }}>{entry.mins}m</span>
              <span style={{ color: "#2d2d2d" }}>{entry.time}</span>
            </div>
          ))}
        </div>

        {/* Footer hint */}
        <div style={{ marginTop: 20, color: "#222", fontSize: 11, letterSpacing: "0.05em", lineHeight: 1.7, textAlign: "center" }}>
          25 min focus · 5 min short break · 15 min long break every 4 sessions
        </div>

      </div>
    );
  }

  ReactDOM.createRoot(document.getElementById("root")).render(<App />);
</script>

</body>
</html>
